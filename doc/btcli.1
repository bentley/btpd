.Dd May 10, 2015
.Dt BTCLI 1
.Os
.Sh NAME
.Nm btcli
.Nd command line interface to btpd
.Sh SYNOPSIS
.Nm btcli
.Ar operation
.Op Ar options
.Sh DESCRIPTION
.Nm
is a utility that interacts with a running
.Xr btpd 1
daemon.
It has several different modes of operation.
.Sh OPERATIONS
.Nm
supports the following commands:
.Sx add ,
.Sx del ,
.Sx kill ,
.Sx list ,
.Sx rate ,
.Sx start ,
.Sx stat ,
and
.Sx stop .
.Pp
.Nm
accepts only one option:
.Bl -tag -width Ds
.It Fl -help Ar operation
Show help for the specified
.Ar operation .
.El
.Ss add
.Nm btcli
.Cm add
.Op Fl NT
.Op Fl l Ar label
.Op Fl n Ar name
.Fl d Ar dir
.Ar
.Pp
Add torrents to btpd.
.Pp
.Cm add
supports the following options:
.Bl -tag -width Ds
.It Fl d Ar dir
Specifies the directory in which the files in the torrent will be downloaded;
it does not specify
.Xr btpd 1 Ns 's
.Dq work
directory.
That is gathered from the environment variable
.Ev HOME .
.It Fl N , Fl -nostart
Do not start the torrent immediately after adding it.
.It Fl T , Fl -topdir
Append the torrent top directory (if any) to the content path.
.It Fl n Ar name
Specifies the name to be displayed for this torrent.
.It Fl l Ar label
Set the label to associate with torrent.
.El
.Ss del
.Nm btcli
.Cm del
.Ar
.Pp
Remove the given torrents from btpd.
.Ss kill
.Nm btcli
.Cm kill
.Pp
Shut down btpd.
.Ss list
.Nm btcli
.Cm list
.Op Fl ai
.Op Fl f Ar format
.Op Ar
.Pp
List the given torrents,
or all torrents (active or inactive) if no arguments are given.
.Pp
.Cm list
supports the following options:
.Bl -tag -width Ds
.It Fl a
List active torrents.
.It Fl f Ar format
Specifies a custom format to use while displaying torrents.
The following is a list of the characters that can be used:
.Bl -diag
.It %n
torrent name
.It %#
torrent number
.It %h
torrent hash
.It %l
torrent label
.It %d
download directory
.It %t
state
.It %P
peer count
.It %^
upload rate
.It %v
download rate
.It %D
downloaded bytes
.It %U
uploaded bytes
.It %g
bytes got
.It %u
bytes uploaded
.It %s
total size, (formatted: prints K, M, G)
.It %S
total size, in bytes
.It %A
available pieces
.It %T
total pieces
.It %H
have pieces
.It %p
percent have (formatted)
.It %r
ratio
.It %%
a percent symbol:
.Ql %
.El
.It Fl i
List inactive torrents.
.El
.Ss rate
.Nm btcli
.Cm rate
.Ar up
.Ar down
.Pp
Set the global upload and download rates in kB/s.
.Ss stat
.Nm btcli
.Cm stat
.Op Fl in
.Op Fl w Ar num
.Op Ar
.Pp
Display stats for active torrents.
.Pp
.Cm stat
supports the following options:
.Bl -tag -width Ds
.It Fl i
Display individual lines for each torrent.
.It Fl n
Display the name of each torrent.
Implies
.Fl i .
.It Fl w Ar num
Display stats every
.Ar num
seconds.
.El
.Ss start
.Nm btcli
.Cm start
.Ar
.Pp
.Nm btcli
.Cm start
.Fl a
.Pp
Activate torrents.
.Cm start
supports the following options:
.Bl -tag -width Ds
.It Fl a
Activate all inactive torrents.
.El
.Ss stop
.Nm btcli
.Cm stop
.Ar
.Pp
.Nm btcli
.Cm stop
.Fl a
.Pp
Deactivate torrents.
.Pp
.Cm stop
supports the following options:
.Bl -tag -width Ds
.It Fl a
Deactivate all torrents.
.El
.Sh USAGE
.Xr btpd 1
must be started before
.Nm
can be used.
.Pp
To start sharing a torrent with btpd, the torrent needs to be added to btpd.
This is done with
.Nm
.Cm add .
Unless otherwise specified,
btpd automatically starts to share the torrent and download any missing data.
If the content directory you specify when adding a torrent does not exist,
btpd will create it.
.Pp
You can see which torrents have been added to btpd with
.Nm
.Cm list .
The list mode also displays a number for each added torrent.
This number can be used to specify the target torrent for the btcli modes,
so you don't have to keep the torrent file after adding it.
.Pp
The upload and download progress can be followed by using the
.Nm
.Cm stat
mode.
Both the list and stat modes use the following indicators to display the state
of a torrent:
.Bl -inset
.It +
The torrent is starting.
This may take time if btpd needs to test the content of this torrent or one
started before it.
.It -
The torrent is being stopped.
.It I
The torrent is inactive.
.It S
btpd is seeding the torrent.
.It L
btpd is leeching the torrent.
.El
.Pp
You can stop an active torrent with
.Nm
.Cm stop .
You can start an inactive torrent by using
.Nm
start .
.Pp
.Sy Note :
Torrents can be specified either with its number or its file.
.Pp
The
.Nm
.Cm del
mode should only be used when you're totally finished with sharing a torrent.
The mode will remove the torrent and its associated data from btpd.
It is a bad idea to remove a not fully downloaded torrent and then add it
again, since btpd has lost information on the not fully downloaded pieces and
will need to download the data again.
.Pp
To shut down btpd use
.Nm
.Cm kill .
.Sh EXAMPLES
Display a list of btpd's torrents and their number, size, status, etc.
.Dl $ btcli list
.Pp
Same as above, but only for torrent 12 and
.Pa my.little.torrent .
.Dl $ btcli list 12 my.little.torrent
.Pp
Same as above but only for active torrents.
.Dl $ btcli list -a
.Pp
Add
.Pa foo.torrent ,
with content dir
.Pa foo.torrent.d ,
and start it.
.Dl $ btcli add -d foo.torrent.d foo.torrent
.Pp
Same as above without starting it.
.Dl $ btcli add -N -d foo.torrent.d foo.torrent
.Pp
Start
.Pa bar.torrent
and torrent number 7.
.Dl $ btcli start bar.torrent 7
.Pp
Stop torrent number 7.
.Dl $ btcli stop 7
.Pp
Stop all active torrents.
.Dl $ btcli stop -a
.Pp
Remove
.Pa bar.torrent
and its associated information from btpd.
.Dl $ btcli del bar.torrent
.Pp
Display a summary of up/download stats for the active torrents.
.Dl $ btcli stat
.Pp
Display the summary once every five seconds.
.Dl $ btcli stat -w 5
.Pp
Same as above, but also display individual stats for each active torrent.
.Dl $ btcli stat -w 5 -i
.Pp
Set the global upload rate to 20 kB/s and download rate to 1 MB/s.
.Dl $ btcli rate 20K 1M
.Pp
Shut down btpd.
.Dl $ btcli kill
.Sh SEE ALSO
.Xr btinfo 1 ,
.Xr btpd 1
.Sh AUTHORS
.An -nosplit
Current maintainers:
.Bl -bullet
.It
.An Marq Schneider Aq Mt queueRAM@gmail.com
.El
.Pp
Past contributors:
.Bl -bullet
.It
Richard Nyberg
.Aq Mt btpd@murmeldjur.se
.El
.Sh BUGS
Known bugs are listed at
.Lk https://github.com/btpd/btpd/issues .
.Pp
Before submitting a bug report,
please verify that you are running the latest version of
.Xr btpd 1 .
